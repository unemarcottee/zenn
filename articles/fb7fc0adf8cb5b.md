---
title: '.NET ã¨ .NET Framework ã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé•ã£ã¦æ‚©ã‚“ã è¨˜éŒ²'
emoji: 'ğŸŒŠ'
type: 'tech' # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['csharp']
published: true
---

# å€‹äººçš„ãªå­¦ã³

- å‹•ä½œç’°å¢ƒã‚’èª¿æŸ»å¯¾è±¡ç’°å¢ƒã¨ã‚ã‚ã›ã¦èª¿æŸ»ã™ã‚‹ã“ã¨

## èµ·ãã¦ãŸã“ã¨

```csharp
dynamic someString = "fetched data expected to be iterable object";
foreach(var k in someString["body"]) // <-- here
{
    Console.WriteLine(k);
}
```

ã‚³ã‚¢ã®å•é¡Œã¨ã—ã¦ `dynamic` å‹ã®å¤‰æ•°ãŒäºˆæœŸã›ãš `string` ã«ãªã£ã¦ã„ãŸã“ã¨ãŒã‚ã‚Šã€éå»äº‹è±¡ã‹ã‚‰ã“ã®å•é¡Œã‚’ç–‘ã£ãŸã€‚

ãŸã ã€ã“ã®ã¨ãä¸Šè¨˜ã® `here` ã®ã¨ã“ã‚ã§

```text
The best overloaded method match for 'string.this[int]' has some invalid arguments
```

ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ãŒèµ·ãã¦ãŠã‚Šã€ã“ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç–‘ã£ã¦ã„ãŸå•é¡Œã«å¯¾ã—ã¦ã€ã™ãã«å™›ã¿åˆã£ã¦ç´å¾—ã§ããªã‹ã£ãŸã€‚

### è€ƒãˆãŸã“ã¨

`variable["key"]` ã® `variable` ãŒ `string` ã§ã‚ã‚‹ã“ã¨ã‚’ç–‘ã£ã¦ã¯ã„ãŸã‚‚ã®ã®(ç¢ºä¿¡ãŒãªã‹ã£ãŸã“ã¨ã‚‚ã‚ã‚Š)ã©ã†ã«ã‚‚ã‚¨ãƒ©ãƒ¼ã¨ã‚ã‚ãªã„ã¨ä¸€æ—¦ã‚¹ãƒ«ãƒ¼ã—ã¦ã—ã¾ã£ãŸã€‚
ã—ã‹ã— `string.this[int]` ã¯ [string å‹ã®ã‚¤ãƒ³ãƒ‡ã‚¯ã‚µ](https://source.dot.net/#System.Private.CoreLib/src/libraries/System.Private.CoreLib/src/System/String.cs,741)ã‚’æŒ‡ã—ã¦ã„ã‚‹ã“ã¨ã¯å½“ç„¶ã¨ã—ã¦ã€å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ã§ `"string"[0]` ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã¯ãªã(ãã‚‚ãã‚‚ char ã‚’å–ã‚‹å ´é¢ãŒãªã‹ã£ãŸ)ã€ã—ã°ã‚‰ãã‚³ãƒ¼ãƒ‰ã‚’å½·å¾¨ã†ã“ã¨ã«ãªã£ãŸã€‚

ä»–ã®å¯èƒ½æ€§ãŒè€ƒãˆã«ãã‹ã£ãŸã®ã§ã€ã‚ã‚‰ãŸã‚ã¦ä¸Šè¨˜ã®ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã‚’ç–‘ã„ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ã¯æ¬¡ã®ã‚ˆã†ã«ç¢ºèªã—ãŸã¨ã“ã‚ã‚¨ãƒ©ãƒ¼ãŒé•ã£ã¦ã„ãŸã€‚

```csharp
var someString = "fetched data expected to be iterable object";
foreach(var k in someString["body"])
{
    Console.WriteLine(k);
}
```

```text
Argument 1: cannot convert from 'string' to 'int'
```

ãã“ã§ã€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯é•ã„ã‚’ç–‘ã£ã¦ã€å‹ã¨ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®çµ„ã¿åˆã‚ã›ã§ç¢ºèªã—ãŸã¨ã“ã‚ã‚¨ãƒ©ãƒ¼ã¯ãã‚Œãã‚Œæ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã€‚

![](/images/fb7fc0adf8cb5b.png)

ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸çš„ã«ã¯ã€`cannot convert from 'string' to 'int'` ã¨è¨€ã£ã¦ãã‚ŒãŸã»ã†ãŒå€‹äººçš„ã«ã¯ã‚ã‹ã‚Šã‚„ã™ã„ã¨æ„Ÿã˜ãŸã€‚
(è¬ãŒè§£ã‘ã¦æŒ¯ã‚Šè¿”ã‚‹ã¨ã€ã¾ã‚åˆ†ã‹ã‚‰ãªã„ã§ã¯ãªã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã¯ã‚ã‚‹ãŒã€éå»ã®äº‹è±¡ã‹ã‚‰ç–‘ã„ãŒè¦‹ãˆã¦ãªã„ã¨ã‚‚ã£ã¨æ‚©ã‚“ã ã ã‚ã†ãªã¨æ€ã†)

ãŸã  dynamic ã§ã¯ ` CallSite`` ã‚’çµŒç”±ã—ã¦å‹•çš„ã«ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é¸æŠã™ã‚‹éƒ½åˆä¸Š  `some invalid` ã¨ã—ã‹è¨€ãˆãªã„ã“ã¨ã¯æƒ³åƒã«é›£ããªã„ã€‚

## ã¾ã¨ã‚

èª¿æŸ»ãŒã†ã¾ãé€²ã¾ãªã‹ã£ãŸåŸå› ã¯ 2 ç‚¹

1. å®Ÿç’°å¢ƒã§ã¯ã€å¤‰æ•°ã¯é–¢æ•°ã®å‘¼ã³å‡ºã—ã®çµæœã‚’ä»£å…¥ã—ã¦ã„ãŸã®ã§ `var` ã¯ `dynamic` ã«æ¨è«–ã•ã‚Œã¦ã„ãŸ(ä¸Šè¨˜æ¤œè¨¼ã‚³ãƒ¼ãƒ‰ã§ã¯ `var` ã¯`string` ã«æ¨è«–ã•ã‚Œã‚‹)
2. ãƒ­ãƒ¼ã‚«ãƒ«ã§ã¯ .NET 7 ã‚’åˆ©ç”¨ã—ã¦ã„ãŸ(å•é¡ŒãŒç™ºç”Ÿã—ã¦ã„ãŸç’°å¢ƒã¯ .NET Framework 4.7 ç³»)

ä»Šå›ã¯ [.NET Fiddle](https://dotnetfiddle.net/)ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§æ‰‹è»½ã«å·®ç•°ã‚’ç¢ºèªã§ããŸã®ã§ã€ç’°å¢ƒã‚’ã‚ã‚ã›ã¦ã®ç¢ºèªã«æ³¨æ„ã—ãŸã„ã€‚
