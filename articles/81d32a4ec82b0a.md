---
title: '<< ã¨ || ã®æ¼”ç®—å­ã®å„ªå…ˆé †åº'
emoji: 'ðŸ¦'
type: 'tech' # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [ruby]
published: true
---

## tl;dr

- `<<` ã¯ `||` ã‚ˆã‚Šå„ªå…ˆã•ã‚Œã‚‹ã®ã§ `()` ã§æ‹¬ã‚ã†

## èµ·ããŸã“ã¨

```ruby
string_array = []
string_array << object&.property.presence || ''
```

ã£ã¦ã‚„ã‚‹ã¨ã property ãŒ nil ã ã¨ã—ã¦ã‚‚ã€é…åˆ—ã«ã¯ nil ãŒå…¥ã‚‹('' ã«è£œæ­£ã•ã‚Œãªã„)ã€‚

`&.` ã¨ã‹ `.presence` ã§å®‰å…¨ã« `nil` ã«ã—ã¦ `|| ''` ã¨ã—ã¦ç©ºæ–‡å­—ã«ã™ã‚‹ã€ã¿ãŸã„ãªã‚¤ãƒ‡ã‚£ã‚ªãƒžãƒ†ã‚£ãƒƒã‚¯ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã‚‹ã¨èµ·ã“ã‚ŠãŒã¡ã‹ã‚‚ã€‚

åŠ ãˆã¦ã€ä»£å…¥(`=`)ã®å„ªå…ˆåº¦ã¯ `||` ã‚ˆã‚Šä½Žã„ã®ã§ã€åŒã˜å³è¾ºã§ã‚‚ `=` ã ã¨ StringClass `<<` ã ã¨ NilClass ã¨ã„ã†å‹•ä½œã«ãªã‚‹ã“ã¨ã«ã‚‚æ³¨æ„ã—ãŸã„ã€‚

ä¸Šè¨˜ã®ã‚ˆã†ã«æ–‡å­—åˆ—ã‚’æœŸå¾…ã—ã¦ã„ã‚‹ã¨ã `nil.to_s` ã¯ç©ºæ–‡å­—(`''`)ã¨ãªã‚Šç‰¹ã«ã‚¨ãƒ©ãƒ¼ã‚’èµ·ã“ã•ãªã„ãŸã‚ã€å•é¡Œã«æ°—ä»˜ãã«ãã„ã€‚

ã¨ã‚Šã‚ã‘ "force_quote" ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ(false)ã§ä½œæˆã—ãŸ CSV ã®è¡Œãƒ‡ãƒ¼ã‚¿é…åˆ—ã§ã‚„ã£ã¦ã„ã‚‹ã¨ nil ã¯ã‚¯ã‚©ãƒ¼ãƒˆãªã—ã€'' ã¯ã‚¯ã‚©ãƒ¼ãƒˆã‚ã‚Šã§å‡ºåŠ›ã•ã‚Œã‚‹ã¨ã„ã†å·®ã¨ã—ã¦ã®ã¿è¡¨ã‚Œã‚‹ã€‚

- ã‚³ãƒ¼ãƒ‰

```ruby
require "csv"
data = CSV.generate("", force_quotes: false) do |csv|
    row = []
    row << nil
    row << nil || ''
    row << (nil || '')
    row << ''
    csv << row
end
print(data)
```

- å‡ºåŠ›ä¾‹

```sh
,,"",""
```

CSV ã‚’ Excel ãªã©ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚¨ãƒ‡ã‚£ã‚¿ã§ç·¨é›†ã™ã‚‹ã¨å•é¡Œã«æ°—ä»˜ã‘ãªã„ã€‚
